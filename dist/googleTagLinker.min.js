/*!
*
*   @giovaniortolanibarbosa/google-tag-linker 0.1.1
*   https://github.com/analytics-debugger/google-tag-linker
*   https://github.com/giovaniortolani/google-tag-linker
*
*   Copyright (c) David Vallejo (https://www.thyngster.com).
*   Copyright (c) Giovani Ortolani Barbosa (https://www.linkedin.com/in/giovani-ortolani-barbosa/).
*   This source code is licensed under the MIT license found in the
*   LICENSE file in the root directory of this source tree.
*
*/

!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(e="undefined"!=typeof globalThis?globalThis:e||self).googleTagLinker=i()}(this,(function(){"use strict";var e=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function i(e,i){return[e,window.btoa(i).replace(/=/g,".")].join("*")}function r(e){return window.atob(e.replace(/\./g,"="))}function n(e,i,r,n){function o(i){var r=(i=function(e,i){if(e=function(e){return new RegExp("(.*?)(^|&)"+e+"=([^&]*)&?(.*)")}(e).exec(i)){var r=e[2],n=e[4];i=e[1],n&&(i=i+r+n)}return i}(e,i)).charAt(i.length-1);return i&&"&"!==r&&(i+="&"),i+c}n=!!n;var t=/([^?#]+)(\?[^#]*)?(#.*)?/.exec(r);if(!t)return"";var a=t[1],s=t[2]||"",f=t[3]||"",c=e+"="+i;return n?f="#"+o(f.substring(1)):s="?"+o(s.substring(1)),""+a+s+f}function o(){for(var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=[window.navigator.userAgent,(new Date).getTimezoneOffset(),window.navigator.userLanguage||window.navigator.language,Math.floor((new Date).getTime()/60/1e3)-0,i?i.join("*"):""].join("*"),n=[],o=0;o<256;o++){e=o;for(var t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;n[o]=e}for(var a=-1,s=0;s<r.length;s++)a=a>>>8^n[255&(a^r.charCodeAt(s))];return((-1^a)>>>0).toString(36)}function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.cookiesNamesList,n=e.gaCookiesPrefix,o=e.conversionLinkerCookiesPrefix,t=new RegExp("^"+n+"_ga"),a=/G[A-Z]1\.[0-9]\.(.+)/,s=[],f=void 0;return Array.isArray(r)?r.forEach((function(e){var r=function(e){for(var i=("; "+document.cookie).split("; "),r=i.length-1;r>=0;r--){var n=i[r].split("=");if(e instanceof RegExp?e.test(n[0]):e===n[0])return[n[0],n[1]]}return[]}(e);e=r[0];var n=r[1];if(n){if(t.test(e))n=n.match(a)[1];else{if("FPLC"===e)return void(f=n);e!==o+"_au"&&"FPAU"!==e||(n=n.split(".").slice(2).join("."))}s.push(i(e,n))}})):Object.keys(r).forEach((function(e){var n=r[e];"FPLC"!==e?s.push(i(e,n)):f=n})),f&&s.push(i("_fplc",f)),s}({cookiesNamesList:e.cookiesNamesList,gaCookiesPrefix:e.gaCookiesPrefix,conversionLinkerCookiesPrefix:e.conversionLinkerCookiesPrefix});return["1",o(r),r.join("*")].join("*")}var a=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"get",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"==typeof window||void 0===window.document)throw"This should be only run on a browser";var s={gaCookiesPrefix:a.gaCookiesPrefix||"",conversionLinkerCookiesPrefix:a.conversionLinkerCookiesPrefix||"_gcl",linkerQueryParameterName:a.linkerQueryParameterName||"_gl",checkFingerPrint:!!a.checkFingerPrint||!1,useFragment:!!a.useFragment||!1};switch(a.cookiesNamesList?s.cookiesNamesList=a.cookiesNamesList:(s.cookiesNamesList=[s.gaCookiesPrefix+"_ga",new RegExp("^"+s.gaCookiesPrefix+"_ga_[A-Z,0-9]"),"FPLC","FPAU"],["_aw","_dc","_gb","_gf","_ha","_au"].forEach((function(e){s.cookiesNamesList.push(s.conversionLinkerCookiesPrefix+e)}))),i){case"get":return t({cookiesNamesList:s.cookiesNamesList,gaCookiesPrefix:s.gaCookiesPrefix,conversionLinkerCookiesPrefix:s.conversionLinkerCookiesPrefix});case"read":return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e,i,n,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.linkerQueryParameterName,s=t.checkFingerPrint,f=(e=a,i=window.location.href,null===(n=new RegExp("[?&]"+e+"=([^&#]*)","i").exec(i))?null:decodeURIComponent(n[1]));if(f){for(var c=f.split("*").slice(2),u={},g=[],k=0;k<c.length;k+=2){var l=c[k],v=c[k+1];g.push(l+"*"+v),u[l]=r(v)}if(s){var m=o(g);if(f.split("*")[1]!==m)return}return u}}({linkerQueryParameterName:e.linkerQueryParameterName,checkFingerPrint:e.checkFingerPrint})}({linkerQueryParameterName:s.linkerQueryParameterName,checkFingerPrint:s.checkFingerPrint});case"decorate":return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.linkerQueryParameterName,o=i.cookiesNamesList,a=i.gaCookiesPrefix,s=i.conversionLinkerCookiesPrefix,f=i.entity,c=i.useFragment,u=t({cookiesNamesList:o,gaCookiesPrefix:a,conversionLinkerCookiesPrefix:s});if(f.tagName){if("A"===f.tagName)return function(i,r,o,t){if(o&&o.href){var a=n(i,r,o.href,t);if(e.test(a))return o.href=a,o}}(r,u,f,c);if("FORM"===f.tagName)return function(i,r,o){if(o&&o.action){var t=(o.method||"").toLowerCase();if("get"===t){for(var a=o.childNodes||[],s=!1,f=0;f<a.length;f++){var c=a[f];if(c.name===i){c.setAttribute("value",r),s=!0;break}}if(!s){var u=document.createElement("input");u.setAttribute("type","hidden"),u.setAttribute("name",i),u.setAttribute("value",r),o.appendChild(u)}return o}if("post"===t){var g=n(i,r,o.action);if(e.test(g))return o.action=g,o}}}(r,u,f)}if("string"==typeof f)return n(r,u,f,c)}({linkerQueryParameterName:s.linkerQueryParameterName,cookiesNamesList:s.cookiesNamesList,gaCookiesPrefix:s.gaCookiesPrefix,conversionLinkerCookiesPrefix:s.conversionLinkerCookiesPrefix,entity:a.entity,useFragment:s.useFragment})}};return a.prototype={},a.answer=42,a}));
